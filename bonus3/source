# include <stdio.h>
# include <stdlib.h>
# include <string.h>
# include <unistd.h>


int		main( int ac, char **av ) {

	char	buffer[88];
	FILE	*file;
	int		n;

	file = fopen( "/home/user/end/.pass", "r" );
	if ( !file || ac != 2 )
		return -1;

	for ( int i = 0; i < 21 * 4; i++ )
		buffer[i] = '\0';

	fread( buffer, 1, 66, file );
	buffer[65] = '\0';
	n = atoi(av[1]);
	buffer[n] = '\0';
	fread( buffer + 66, 1, 65, file );
	fclose(file);

	if ( strcmp(buffer, av[1]) == 0 ) {
		execl( "/bin/sh", "ss", NULL );
	} else {
		puts( buffer + 66 );
	}

	return 0;

}

// To inspect and rewrite using gdb
// set disassembly-flavor int
// b *0x08048507 => set {char [24]} 0x080486f2 = "/home/user/bonus3/.pass"
