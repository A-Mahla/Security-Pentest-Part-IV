# include <stdio.h>
# include <stdlib.h>
# include <string.h>
# include <time.h>

void decrypt(int nb);


void	test(int pass, int nb) {

	void			(*tmp)(void);
	unsigned int	i;

	if ( (i = (unsigned int)(nb - pass)) > 21 ) {

		tmp = (void (*)(void))((long)((pass << 2) + 0x80489f0));
		tmp();
		
		if ( i <= 9 || i >= 16 )
			decrypt( i );
		else
			decrypt( rand() );
		
	} else {
		decrypt( rand() );
	}

}


int main(void) {

	int pass;

	srand( time(NULL) );
	puts( "***********************************" );
	puts( "*\t\tlevel03\t\t**" );
	puts( "***********************************" );
	printf( "Password:" );
	scanf( "%d", &pass );
	test( pass, 322424845 );

	return 0;

}

// gefâž¤  x/24wx 0x80489f0
// 0x80489f0:	0x0804884a	0x08048775	0x08048785	0x08048795
// 0x8048a00:	0x080487a5	0x080487b5	0x080487c5	0x080487d5
// 0x8048a10:	0x080487e2	0x080487ef	0x0804884a	0x0804884a
// 0x8048a20:	0x0804884a	0x0804884a	0x0804884a	0x0804884a
// 0x8048a30:	0x080487fc	0x08048809	0x08048816	0x08048823
// 0x8048a40:	0x08048830	0x0804883d	0x2a2a2a2a	0x2a2a2a2a

// (gdb) set $addr = 0x80489f0
// (gdb) while $addr <= 0x8048a44
// > x/x *$addr
// > set $addr = $addr + 4
// > end
// 0x804884a <test+259>:	0xfffcd1e8
// 0x8048775 <test+46>:	0x89f4458b
// 0x8048785 <test+62>:	0x89f4458b
// 0x8048795 <test+78>:	0x89f4458b
// 0x80487a5 <test+94>:	0x89f4458b
// 0x80487b5 <test+110>:	0x89f4458b
// 0x80487c5 <test+126>:	0x89f4458b
// 0x80487d5 <test+142>:	0x89f4458b
// 0x80487e2 <test+155>:	0x89f4458b
// 0x80487ef <test+168>:	0x89f4458b
// 0x804884a <test+259>:	0xfffcd1e8
// 0x804884a <test+259>:	0xfffcd1e8
// 0x804884a <test+259>:	0xfffcd1e8
// 0x804884a <test+259>:	0xfffcd1e8
// 0x804884a <test+259>:	0xfffcd1e8
// 0x804884a <test+259>:	0xfffcd1e8
// 0x80487fc <test+181>:	0x89f4458b
// 0x8048809 <test+194>:	0x89f4458b
// 0x8048816 <test+207>:	0x89f4458b
// 0x8048823 <test+220>:	0x89f4458b
// 0x8048830 <test+233>:	0x89f4458b
// 0x804883d <test+246>:	0x89f4458b

